<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ƒê·∫°o C·ªßa Code - L·ªùi K·∫øt</title>
    <link rel="stylesheet" href="assets/css/main.css">
    <link rel="stylesheet" href="assets/css/animations.css">
    <link rel="stylesheet" href="assets/css/scroll-navigation.css">
    <link rel="stylesheet" href="assets/css/edge-glow.css">
    <link rel="stylesheet" href="assets/css/outro-fixes.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">
</head>
<body>
    <div class="container chapter-container">
        <header>
            <div class="home-header">
                <a href="index.html" class="home-link">ƒê·∫†O C·ª¶A CODE</a>
            </div>
            <nav class="navigation">
                <div class="chapter-nav chapter-header-nav" id="chapter-navigation">
                    <a href="chapter.html?id=81" class="prev-chapter">Ch∆∞∆°ng tr∆∞·ªõc</a>
                    <a href="index.html" class="next-chapter">Trang ch·ªß</a>
                </div>
            </nav>
        </header>
        
        <main class="chapter-content" id="outro-content">
            <!-- Outro content will be dynamically inserted here -->
        </main>
        
        <footer>
            <div class="chapter-footer-nav" id="footer-navigation">
                <a href="chapter.html?id=81" class="prev-chapter">Ch∆∞∆°ng tr∆∞·ªõc</a>
                <a href="index.html" class="next-chapter">Trang ch·ªß</a>
            </div>
            <div class="footer-content">
                <p>&copy; 2025 ƒê·∫°o C·ªßa Code</p>
            </div>
        </footer>
    </div>
    
    <div class="theme-switcher">
        <button class="theme-button light" data-theme="light" title="Light theme">‚òÄÔ∏è</button>
        <button class="theme-button dark" data-theme="dark" title="Dark theme">üåô</button>
        <button class="theme-button brown" data-theme="brown" title="Brown theme">üìú</button>
    </div>
    
    <script src="assets/js/main.js"></script>
    <script src="assets/js/scroll-navigation.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Kh·ªüi t·∫°o theme manager t·ª´ main.js
            if (typeof themeManager !== 'undefined') {
                themeManager.init();
            }
            
            // T·∫£i n·ªôi dung c·ªßa outro.json
            fetch('data/outro.json')
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Network response was not ok');
                    }
                    return response.json();
                })
                .then(data => {
                    renderOutroContent(data);
                })
                .catch(error => {
                    console.error('Error loading outro data:', error);
                    document.getElementById('outro-content').innerHTML = '<p>ƒê√£ x·∫£y ra l·ªói khi t·∫£i d·ªØ li·ªáu. Vui l√≤ng th·ª≠ l·∫°i sau.</p>';
                });
        });

        // Render n·ªôi dung outro
        function renderOutroContent(data) {
            const contentElement = document.getElementById('outro-content');
            if (!contentElement) return;
            
            let contentHTML = '';
            
            // Th√™m ti√™u ƒë·ªÅ n·∫øu c√≥
            if (data.title) {
                contentHTML += `<h1 class="chapter-heading fade-in">${data.title}</h1>`;
            } else {
                contentHTML += `<h1 class="chapter-heading fade-in">L·ªùi K·∫øt</h1>`;
            }
            
            // Render c√°c ƒëo·∫°n th∆° (verses)
            contentHTML += `<div class="verse-container">`;
            
            if (data.content && data.content.verses && data.content.verses.length > 0) {
                data.content.verses.forEach(verse => {
                    contentHTML += `<p class="verse" id="${verse.id}">`;
                    
                    verse.lines.forEach((line, index) => {
                        // X·ª≠ l√Ω ƒë·ªãnh d·∫°ng Markdown cho t·ª´ng d√≤ng
                        let parsedLine = line;
                        
                        // X·ª≠ l√Ω in ƒë·∫≠m
                        parsedLine = parsedLine.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
                        
                        // X·ª≠ l√Ω in nghi√™ng
                        parsedLine = parsedLine.replace(/\*(.*?)\*/g, '<em>$1</em>');
                        
                        contentHTML += parsedLine;
                        if (index < verse.lines.length - 1) {
                            contentHTML += `<br>`;
                        }
                    });
                    
                    contentHTML += `</p>`;
                });
            }
            
            contentHTML += '</div>';
            
            // Hi·ªÉn th·ªã quote n·∫øu c√≥
            if (data.content && data.content.quote && data.content.quote.text) {
                contentHTML += `
                    <blockquote class="outro-quote fade-in-delayed">
                        <p>${data.content.quote.text}</p>
                        ${data.content.quote.author ? `<footer>‚Äî <em>${data.content.quote.author}</em></footer>` : ''}
                    </blockquote>
                `;
            }
            
            contentElement.innerHTML = contentHTML;
            
            // √Åp d·ª•ng class fade-in cho container
            document.querySelector('.container').classList.add('fade-in-content');
            
            // Th√™m c√°c ph·∫ßn t·ª≠ glow edge
            if (typeof addGlowElements === 'function') {
                addGlowElements();
            }
            
            // C·∫≠p nh·∫≠t styles cho navigation ƒë·ªÉ ƒë·ªìng b·ªô v·ªõi trang chapter
            styleNavigation();
        }
        
        // H√†m n√†y √°p d·ª•ng c√πng ki·ªÉu d√°ng cho navigation nh∆∞ trong main.js
        function styleNavigation() {
            // √Åp d·ª•ng style gi·ªëng chapter.html cho c√°c ph·∫ßn t·ª≠ navigation
            const headerNav = document.getElementById('chapter-navigation');
            const footerNav = document.getElementById('footer-navigation');
            
            if (headerNav) {
                headerNav.classList.add('fade-in');
                // ƒê·∫£m b·∫£o c·∫•u tr√∫c v√† spacing gi·ªëng v·ªõi chapter.html
                headerNav.style.display = 'flex';
                headerNav.style.justifyContent = 'space-between';
                headerNav.style.width = '100%';
                headerNav.style.maxWidth = '400px';
            }
            
            if (footerNav) {
                footerNav.classList.add('fade-in');
                // ƒê·∫£m b·∫£o c·∫•u tr√∫c v√† spacing gi·ªëng v·ªõi chapter.html
                footerNav.style.display = 'flex';
                footerNav.style.justifyContent = 'space-between';
                footerNav.style.width = '100%';
                footerNav.style.maxWidth = '400px';
                footerNav.style.margin = '2rem auto 1rem';
            }
        }
    </script>
</body>
</html>
